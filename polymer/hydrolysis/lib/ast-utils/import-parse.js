"use strict";var dom5=require("dom5");var p=dom5.predicates;var isHtmlImportNode=p.AND(p.hasTagName("link"),p.hasAttrValue("rel","import"),p.NOT(p.hasAttrValue("type","css")));var isStyleNode=p.OR(p.hasTagName("style"),p.AND(p.hasTagName("link"),p.hasAttrValue("rel","stylesheet")),p.AND(p.hasTagName("link"),p.hasAttrValue("rel","import"),p.hasAttrValue("type","css")));function addNode(e,t){if(isHtmlImportNode(e)){t.import.push(e)}else if(isStyleNode(e)){t.style.push(e)}else if(t.hasOwnProperty(e.tagName)){t[e.tagName].push(e)}}function getLineAndColumn(e,t){if(t>e.length){return undefined}var a=e.slice(0,t+1);var r=a.split("\n");var o=r.length;var l=r[r.length-1].length;return{line:o,column:l}}var importParse=function e(t,a){var r;try{r=dom5.parse(t,{locationInfo:true})}catch(o){console.log(o);return null}dom5.treeMap(r,function(e){if(e.__location&&e.__location.start>=0){e.__locationDetail=getLineAndColumn(t,e.__location.start);if(a){e.__ownerDocument=a}}});var l={base:[],template:[],script:[],style:[],"import":[],"dom-module":[]};var s=[].concat(r.childNodes);var i;while(s.length>0){i=s.shift();if(i&&i.tagName){s=s.concat(i.childNodes);addNode(i,l)}}l.ast=r;return l};module.exports=importParse;