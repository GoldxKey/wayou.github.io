"use strict";var estraverse=require("estraverse");function matchesCallExpression(e,t){if(!e.property||!e.object)return;console.assert(t.length>=2);if(e.property.name!==t[t.length-1])return false;if(t.length==2&&e.object.type==="Identifier"){return e.object.name===t[0]}if(t.length>2&&e.object.type=="MemberExpression"){return matchesCallExpression(e.object,t.slice(0,t.length-1))}return false}function objectKeyToString(e){if(e.type=="Identifier"){return e.name}if(e.type=="Literal"){return e.value}if(e.type=="MemberExpression"){return objectKeyToString(e.object)+"."+objectKeyToString(e.property)}}var CLOSURE_CONSTRUCTOR_MAP={Boolean:"boolean",Number:"number",String:"string"};function closureType(e){if(e.type.match(/Expression$/)){return e.type.substr(0,e.type.length-10)}else if(e.type==="Literal"){return typeof e.value}else if(e.type==="Identifier"){return CLOSURE_CONSTRUCTOR_MAP[e.name]||e.name}else{throw{message:"Unknown Closure type for node: "+e.type,location:e.loc.start}}}function getAttachedComment(e){var t=getLeadingComments(e)||getLeadingComments(e.key);if(!t){return}return t[t.length-1]}function getEventComments(e){var t=[];estraverse.traverse(e,{enter:function(e){var r=(e.leadingComments||[]).concat(e.trailingComments||[]).map(function(e){return e.value}).filter(function(e){return e.indexOf("@event")!=-1});t=t.concat(r)}});return t.filter(function(e,t,r){return r.indexOf(e)===t})}function getLeadingComments(e){if(!e){return}var t=e.leadingComments;if(!t||t.length===0)return;return t.map(function(e){return e.value})}function toPropertyDescriptor(e){var t={name:objectKeyToString(e.key),type:closureType(e.value),desc:getAttachedComment(e)};if(e.value.type==="FunctionExpression"){t.params=(e.value.params||[]).map(function(e){return{name:e.name}})}return t}module.exports={closureType:closureType,getAttachedComment:getAttachedComment,getEventComments:getEventComments,matchesCallExpression:matchesCallExpression,objectKeyToString:objectKeyToString,toPropertyDescriptor:toPropertyDescriptor};